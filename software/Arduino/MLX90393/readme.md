MLX90393 足端传感器串口命令操作说明



本程序支持通过串口输入命令来控制传感器工作模式、温度补偿标定、数据输出等功能。以下为完整命令列表与操作流程。



1\. 数据流控制

命令	说明

start	开始数据输出。先采集 NORM\_WINDOW 帧均值作为归一化基线，基线就绪后输出归一化后的 12 维磁场数据。

stop	停止数据输出。

2\. 滤波/OSR 模式



滤波与过采样（OSR）可在 4 种模式间切换，影响采样带宽与噪声性能。默认 BALANCED。



命令	模式说明

mode\_fast	FAST\_RESP：OSR=1x，DIG\_FILT=1，快速响应，抗噪较弱。

mode\_bal	BALANCED：OSR=2x，DIG\_FILT=3，通用模式，响应与噪声折中。

mode\_low	LOW\_NOISE：OSR=4x，DIG\_FILT=5，低噪声，采样周期需更长。

mode\_ultra	ULTRA\_LOW\_NOISE：OSR=8x，DIG\_FILT=6，极低噪声，带宽最低。

3\. 温度相关操作

3.1 查看温度

命令	说明

temp	打印 4 路传感器的片上温度（摄氏度）。

3.2 三点温度标定



⚠️ 标定时需处于静磁环境，并且温度稳定在目标点附近。



在 25℃ 环境，输入：cal25

→ 系统采集 128 帧均值，记录为 25℃ 偏置。



升温至 40℃，输入：cal40

→ 记录 40℃ 偏置。



升温至 60℃，输入：cal60

→ 记录 60℃ 偏置。



输入：cal\_fit

→ 使用 25/40/60 三点拟合出二次多项式补偿系数。



输入：cal\_save

→ 将拟合结果保存到 /mlx\_cal.txt（掉电不丢失）。



下次上电程序会自动执行 cal\_load 读取文件，补偿参数自动生效。



其它相关命令：



命令	说明

cal\_load	手动加载 /mlx\_cal.txt。通常上电会自动执行。

cal\_stat	查看每颗传感器每轴的拟合系数 c0/c1/c2。

4\. 归一化（零均值化）



start 会默认启用归一化：先采集 N 帧均值作为基线，之后输出 (x-mean)。



命令	说明

norm\_on	开启归一化（默认）。

norm\_off	关闭归一化，直接输出已温度补偿的数据。

norm\_recal	重新采集基线（下一次会重新收集 N 帧）。

norm\_window N	设置归一化窗口帧数（推荐 5–10，默认 8）。

norm\_stat	查看归一化状态（是否启用、是否就绪、基线均值）。

5\. 典型使用流程



首次标定（需要一次）



在 25℃ 输入：cal25



在 40℃ 输入：cal40



在 60℃ 输入：cal60



输入：cal\_fit → 拟合系数



输入：cal\_save → 掉电保存



上电使用



程序自动 cal\_load，读取补偿参数。



串口输入：start，等待基线就绪（会提示 NORM\_READY），开始输出归一化后的数据。



可选调整



需要更快/更稳 → 切换滤波模式（mode\_fast / mode\_low / mode\_ultra）。



如果换了环境或传感器 → 重新执行 25/40/60 三点标定并保存。

